<!DOCTYPE html>
<html>
    <head>
        <title>Ej5</title>
    </head>
    <body onload="init()">
        <canvas id="myCanvas" width="640" height="480"></canvas><br>
        <b>Rotation</b>
        <input type="checkbox" name="rotation" checked><br>
        <b>WebGL primitive</b>
        <input type="radio" name="primitive" value="triangles" checked> Triangles
        <input type="radio" name="primitive" value="lines"> Lines<br>
        <b>Projection type</b>
        <input type="radio" name="projection" value="perspective" checked> Perspective
        <input type="radio" name="projection" value="orthographic"> Orthographic<br>
    </body>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/gl-matrix/2.8.1/gl-matrix-min.js"></script>

    <script id="shaderVs" type="x-shader/x-vertex">
        attribute vec4 a_Position;
        uniform mat4 u_Matrix;
        void main() {
            gl_Position =u_Matrix * a_Position;
    
        }
    </script>

    <script id="shaderFs" type="x-shader/x-fragment">
        precision mediump float;
        uniform vec4 u_FragColor;
        void main() {
            gl_FragColor = u_FragColor;
        }
    </script>

    <script>
        function init(){
            // Get canvas object from the DOM
            var canvas = document.getElementById("myCanvas");

            // Init WebGL context
            var gl = canvas.getContext("webgl");
            if (!gl) {
                console.log("Failed to get the rendering context for WebGL");
                return;
            }

            // Init shaders
            var vs = document.getElementById('shaderVs').innerHTML;
            var fs = document.getElementById('shaderFs').innerHTML;
            if (!initShaders(gl, vs, fs)) {
                console.log('Failed to intialize shaders.');
                return;
            }
        }

        function initShaders(gl, vs_source, fs_source) {
            // Compile shaders
            var vertexShader = makeShader(gl, vs_source, gl.VERTEX_SHADER);
            var fragmentShader = makeShader(gl, fs_source, gl.FRAGMENT_SHADER);

            // Create program
            var glProgram = gl.createProgram();

            // Attach and link shaders to the program
            gl.attachShader(glProgram, vertexShader);
            gl.attachShader(glProgram, fragmentShader);
            gl.linkProgram(glProgram);
            if (!gl.getProgramParameter(glProgram, gl.LINK_STATUS)) {
                alert("Unable to initialize the shader program");
                return false;
            }

            // Use program
            gl.useProgram(glProgram);
            gl.program = glProgram;

            return true;
        }

        function makeShader(gl, src, type) {
            var shader = gl.createShader(type);
            gl.shaderSource(shader, src);
            gl.compileShader(shader);
            if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {
                alert("Error compiling shader: " + gl.getShaderInfoLog(shader));
                return;
            }
            return shader;
        }
    </script>
</html>